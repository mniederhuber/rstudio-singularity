scale_fill_viridis(name = "Median KD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
geom_point(size = 0.5) +
scale_fill_viridis(name = "Median\n KD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
geom_point(size = 0.5) +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
geom_point(size = 0.5, shape = 22) +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
geom_point(size = 0.5, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
geom_point(size = 0.8, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), alpha = 0.5, outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), color = "white", outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), color = "grey10", outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), color = "grey50", outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), color = "grey20", outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), color = "grey20", outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(option = "turbo", name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(option = "turbo", name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::summarise(m = mean(KDtoWT)) %>%
ggplot(aes(line, symbol, color = m)) +
geom_point(size = 6) +
scale_color_viridis(option = "turbo")
library(magrittr)
library(ggplot2)
library(viridis)
outdata <- read.csv('output/outdata.csv') %>%
dplyr::mutate(id = paste(symbol, line, sep = "_"))
forcats::fct_reorder(outdata$line, outdata$KDtoWT)
outdata %>%
dplyr::filter(stack >= 10 & gfp >= 10 & size == "1024x1024") %>%
dplyr::group_by(symbol, line) %>%
dplyr::mutate(med = median(KDtoWT)) %>%
ggplot(aes(forcats::fct_reorder(id, KDtoWT), KDtoWT)) +
geom_boxplot(aes(fill = med), outlier.shape = NA) +
#geom_point(size = 1, shape = 22, fill = "white") +
scale_fill_viridis(name = "Median\nKD/WT") +
ylab("brDisc KD/WT") +
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),
axis.title.x = element_blank())
getcwd()
pbmc.data <- Seurat::Read10X('filtered_gene_bc_matrices/hg19/')
pbmc.data %>%
Seurat::CreateSeuratObject(project = 'pbmc3k',
min.cells = 3,
min.features = 200)
library(patchwork)
library(magrittr)
pbmc.data <- Seurat::Read10X('filtered_gene_bc_matrices/hg19/')
pbmc.data %>%
Seurat::CreateSeuratObject(project = 'pbmc3k',
min.cells = 3,
min.features = 200)
pbmc
pbmc.data <- Seurat::Read10X('filtered_gene_bc_matrices/hg19/')
pbmc <- pbmc.data %>%
Seurat::CreateSeuratObject(project = 'pbmc3k',
min.cells = 3,
min.features = 200)
pbmc
pbmc$orig.ident
pbmc$nCount_RNA
pbmc$nFeature_RNA
pbmc@meta.data
pbmc@assays
pbmc@graphs
pbmc[['percent.mt']]
pbmc %>%
Seurat::PercentageFeatureSet(pattern = '^MT-')
pbmc[['percent.mt']] <- pbmc %>%
Seurat::PercentageFeatureSet(pattern = '^MT-')
library(ggplot2)
pbmc@meta.data
pbmc@meta.data %>%
ggplot(aes(nFeature_RNA, percent.mt)) +
geom_point()
pbmc@meta.data %>%
ggplot(aes(orig.ident, percent.mt)) +
geom_point()
pbmc@meta.data
pbmc@meta.data %>%
ggplot(aes(percent.mt)) +
geom_histogram()
pbmc@meta.data
pbmc@meta.data %>%
ggplot(aes(percent.mt)) +
geom_violin()
pbmc@meta.data %>%
ggplot(aes(percent.mt)) +
geom_violin(stat = 'identity')
pbmc@meta.data %>%
ggplot(aes(percent.mt)) +
geom_violin(aes(stat = 'identity'))
pbmc@meta.data %>%
ggplot(aes(0,percent.mt)) +
geom_violin()
pbmc %>%
Seurat::VlnPlot(features = c('nFeature_RNA','nCount_RNA','percent.mt'), ncol = 3)
pbmc@meta.data %>%
purrr::map(colnames(.), function(x){
message(x)
})
pbmc@meta.data %>%
purrr::map(colnames(.), function(x){
.$x
})
pbmc@meta.data %>%
purrr::map(colnames(.), function(x){
.$x
})
message(.$x)
pbmc@meta.data %>%
purrr::map(colnames(.), function(x){
message(.$x)
})
pbmc@meta.data %>%
purrr::map(colnames(.), function(x){
message(pbmc$meta.data$x)
})
pbmc@meta.data %>%
tidyr::pivot_longer()
pbmc@meta.data %>%
tibble::rowid_to_column('id') %>%
tidyr::pivot_longer()
pbmc@meta.data %>%
tibble::rowid_to_column('id') %>%
tidyr::pivot_longer('id')
pbmc@meta.data %>%
tibble::rowid_to_column('id') %>%
tidyr::pivot_longer(c(orig.ident, nCount_RNA, nFeature_RNA))
pbmc@meta.data %>%
tibble::rowid_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA))
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA))
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt))
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin()
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
facet_grid(name)
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
facet_grid(~name)
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
facet_grid(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point() +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = position_dodge()) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = jitter()) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = jitter(1)) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = position_jitter(1)) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = position_jitter(0.1)) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = position_jitter(0.3)) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = position_jitter(0.3), alpha = 0.5) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = position_jitter(0.3), alpha = 0.2) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = position_jitter(0.3), alpha = 0.2, shape = 21) +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
geom_point(position = position_jitter(0.3), alpha = 0.2, shape = 21, color = 'black') +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
# geom_point(position = position_jitter(0.3), alpha = 0.2, shape = 21, color = 'black') +
facet_wrap(~name, scales = 'free_y')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
# geom_point(position = position_jitter(0.3), alpha = 0.2, shape = 21, color = 'black') +
facet_wrap(~name, scales = 'free_y')
pbmc %>%
dplyr::filter(nFeature_RNA > 200 )
pbmc %>%
subset(nFeature_RNA > 200 )
pbmc %>%
subset(nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5)
pbmc.filt <- pbmc %>%
subset(nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5)
pbmc.filt@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
# geom_point(position = position_jitter(0.3), alpha = 0.2, shape = 21, color = 'black') +
facet_wrap(~name, scales = 'free_y')
pbmc <- pbmc %>%
subset(nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5)
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
# geom_point(position = position_jitter(0.3), alpha = 0.2, shape = 21, color = 'black') +
facet_wrap(~name, scales = 'free_y')
pbmc %>%
Seurat::NormalizeData(normalization.method = 'LogNormalize', scale.factor = 10000)
pbmc <- pbmc %>%
Seurat::NormalizeData(normalization.method = 'LogNormalize', scale.factor = 10000)
library(patchwork)
library(magrittr)
library(ggplot2)
pbmc.data <- Seurat::Read10X('filtered_gene_bc_matrices/hg19/')
pbmc <- pbmc.data %>%
Seurat::CreateSeuratObject(project = 'pbmc3k',
min.cells = 3,
min.features = 200)
pbmc
pbmc[['percent.mt']] <- pbmc %>%
Seurat::PercentageFeatureSet(pattern = '^MT-')
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
# geom_point(position = position_jitter(0.3), alpha = 0.2, shape = 21, color = 'black') +
facet_wrap(~name, scales = 'free_y')
pbmc %>%
Seurat::VlnPlot(features = c('nFeature_RNA','nCount_RNA','percent.mt'), ncol = 3)
pbmc <- pbmc %>%
subset(nFeature_RNA > 200 & nFeature_RNA < 2500 & percent.mt < 5)
pbmc@meta.data %>%
tibble::rownames_to_column('id') %>%
tidyr::pivot_longer(c(nCount_RNA, nFeature_RNA, percent.mt)) %>%
ggplot(aes(orig.ident, value, color = name)) +
geom_violin() +
# geom_point(position = position_jitter(0.3), alpha = 0.2, shape = 21, color = 'black') +
facet_wrap(~name, scales = 'free_y')
# default settings
pbmc <- pbmc %>%
Seurat::NormalizeData(normalization.method = 'LogNormalize', scale.factor = 10000)
pbmc %>%
Seurat::FindVariableFeatures(selection.method = 'vst', nfeatures = 2000)
pbmc <- pbmc %>%
Seurat::FindVariableFeatures(selection.method = 'vst', nfeatures = 2000)
head(seurat::VariableFeatures(pbmc), 10)
head(Seurat::VariableFeatures(pbmc), 10)
Seurat::VariableFeaturePlot(pbmc)
top10 <- head(Seurat::VariableFeatures(pbmc), 10)
Seurat::LabelPoints(Seurat::VariableFeaturePlot(pbmc), points = top10, repe = T)
all.genes <- rownames(pbmc)
pbmc <- Seurat::ScaleData(pbmc, features = all.genes)
pbmc %>%
Seurat::RunPCA(, features = Seurat::VariableFeatures(pbmc))
pbmc <- pbmc %>% Seurat::RunPCA(, features = Seurat::VariableFeatures(pbmc))
print(pbmc[['pca']], dims = 1:5, nfeatures = 5)
pbmc %>%
Seurat::VizDimLoadings(dims = 1:2, reduction = 'pca')
Seurat::ElbowPlot(pbmc)
pbmc %>% Seurat::FindClusters(resolution = 0.5)
pbmc <- pbmc %>% Seurat::FindNeighbors(dims = 1:10)
pbmc %>% Seurat::FindClusters(resolution = 0.5)
pbmc <- pbmc %>% Seurat::FindClusters(resolution = 0.5)
pbmc %>% Seurat::RunUMAP(features = Seurat::VariableFeatures(.))
pbmc <- pbmc %>% Seurat::RunUMAP(features = Seurat::VariableFeatures(.))
pbmc %>%
Seurat::DimPlot(reduction = 'umap')
pbmc$seurat_clusters
pbmc@reductions
pbmc@reductions$umap$umap_1
pbmc@reductions$umap
pbmc@reductions$umap %>% data.frame()
pbmc@reductions$umap@feature.loadings
pbmc@reductions$umap@feature.loadings
pbmc@reductions$umap@key
pbmc@reductions$umap@feature.loadings.projected
pbmc@reductions$umap
pbmc@reductions$umap %>% data.frame()
pbmc@reductions$umap@global
pbmc@reductions$pca$PC_1
pbmc@assays
